## ZAB协议

`ZAB-ZooKeeper Atomic Broadcast(zookeeper原子消息广播协议).是为分布式协调服务Zookeeper专门设计的一种支持崩溃恢复的原子广播协议`

### 基础原理

​		Zookeeper采用单一的主进程来接受并处理客户端的所有事务请求，并采用ZAB广播协议，将服务器的状态变更广播到所有的副本节点上去

### 核心

`定义了那些会改变服务器数据状态的事务请求的处理方式，既:`

`所有的事务请求必须由一个全局唯一的服务器进行协调处理,这样的服务器就成为Leader服务器，而余下的就是Follower服务器。Leader服务器会负责将一个客户端事务请求转换成一个事务Proposal（提议），并将该Proposal分发给所有的Follower节点，当集群环境中有超过一半的Follower节点完成响应后，Leader节点就会向所有的Follower节点发送commit请求，要求将前一个Proposal进行提交`

==整个过程有点类似2PC==

### 介绍





#### 疑惑点

+ 客户端事务的完成时间点.

  + 是在Leader节点处理完客户端事务后，转换成Proposal前

    > 如果是这种情况的话,就存在服务器崩溃数据丢失的可能。

  + 还是所有Follower节点commit结束后

    >  这种情况的话就有可能影响ZK的吞吐量了

+ 如果解决分布式系统中常见的脑裂问题

  ​	已知的是集群中一半以上的机器才能选举出Leader服务器。那整个集群的数量是如果统计出来的呢，或者在哪个时间点统计的

+ 